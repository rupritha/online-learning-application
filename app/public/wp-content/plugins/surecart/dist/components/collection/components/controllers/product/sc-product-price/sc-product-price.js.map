{"version":3,"file":"sc-product-price.js","sourceRoot":"","sources":["../../../../../src/components/controllers/product/sc-product-price/sc-product-price.tsx"],"names":[],"mappings":"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","sourcesContent":["/**\n * External dependencies.\n */\nimport { Component, h, Prop, Host } from '@stencil/core';\nimport { __, _n } from '@wordpress/i18n';\n\n/**\n * Internal dependencies.\n */\nimport { state } from '@store/product';\nimport { state as upsellState } from '@store/upsell';\nimport { Price, Variant } from '../../../../types';\n\n@Component({\n  tag: 'sc-product-price',\n  styleUrl: 'sc-product-price.scss',\n  shadow: true,\n})\nexport class ScProductPrice {\n  /** The product's prices. */\n  @Prop() prices: Price[];\n\n  /** The sale text */\n  @Prop() saleText: string;\n\n  /** The product id */\n  @Prop() productId: string;\n\n  renderRange() {\n    return state[this.productId]?.range_display_amount;\n  }\n\n  renderVariantPrice(selectedVariant: Variant) {\n    const variant = state[this.productId]?.variants?.find(variant => variant?.id === selectedVariant?.id);\n    return this.renderPrice(state[this.productId].selectedPrice, variant);\n  }\n\n  renderPrice(price: Price, variant: Variant = null) {\n    const originalAmount = variant?.display_amount ?? price?.display_amount ?? '';\n\n    // maybe change for upsells.\n    const amount = upsellState?.line_item?.total_amount || price?.amount;\n    const upsellDisplayAmount = upsellState?.line_item?.total_display_amount;\n    const displayAmount = upsellDisplayAmount ? upsellDisplayAmount : originalAmount;\n\n    const scratchAmount = upsellState?.line_item?.scratch_amount || price?.scratch_amount;\n    const upsellScratchDisplayAmount = upsellState?.line_item?.subtotal_display_amount;\n    const scratchDisplayAmount = upsellScratchDisplayAmount ? upsellScratchDisplayAmount : price?.scratch_display_amount;\n\n    return (\n      <sc-price\n        currency={price?.currency}\n        amount={amount}\n        displayAmount={displayAmount}\n        scratchAmount={scratchAmount}\n        scratchDisplayAmount={scratchDisplayAmount}\n        saleText={this.saleText}\n        adHoc={price?.ad_hoc}\n        trialDurationDays={price?.trial_duration_days}\n        setupFeeText={price?.setup_fee_text}\n        setupFeeAmount={price?.setup_fee_enabled ? price?.setup_fee_amount : null}\n        setupFeeName={price?.setup_fee_enabled ? price?.setup_fee_name : null}\n        recurringPeriodCount={price?.recurring_period_count}\n        recurringInterval={price?.recurring_interval}\n        recurringIntervalCount={price?.recurring_interval_count}\n      />\n    );\n  }\n\n  render() {\n    return (\n      <Host role=\"paragraph\">\n        {(() => {\n          if (state[this.productId]?.selectedVariant) {\n            return this.renderVariantPrice(state[this.productId]?.selectedVariant);\n          }\n\n          if (state[this.productId]?.selectedPrice) {\n            return this.renderPrice(state[this.productId].selectedPrice);\n          }\n\n          if (state[this.productId]?.prices?.length) {\n            return this.renderRange();\n          }\n\n          return <slot />;\n        })()}\n      </Host>\n    );\n  }\n}\n"]}