{"version":3,"file":"sc-line-item-total.js","sourceRoot":"","sources":["../../../../../src/components/controllers/checkout-form/line-item-total/sc-line-item-total.tsx"],"names":[],"mappings":"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","sourcesContent":["/**\n * External dependencies.\n */\nimport { Component, Fragment, h, Prop } from '@stencil/core';\nimport { __, sprintf } from '@wordpress/i18n';\n\n/**\n * Internal dependencies.\n */\nimport { formBusy } from '@store/form/getters';\nimport { state as checkoutState } from '@store/checkout';\nimport { Checkout } from '../../../../types';\n\n@Component({\n  tag: 'sc-line-item-total',\n  styleUrl: 'sc-line-item-total.scss',\n  shadow: true,\n})\nexport class ScLineItemTotal {\n  @Prop() total: 'total' | 'subtotal' = 'total';\n  @Prop() size: 'large' | 'medium';\n  @Prop() checkout: Checkout;\n\n  order_key = {\n    total: 'total_amount',\n    subtotal: 'subtotal_amount',\n    amount_due: 'amount_due',\n  };\n\n  hasInstallmentPlan(checkout: Checkout) {\n    return checkout?.full_amount !== checkout?.subtotal_amount;\n  }\n\n  hasSubscription(checkout: Checkout) {\n    return (checkout?.line_items?.data || []).some(\n      lineItem => lineItem?.price?.recurring_interval === 'month' && !!lineItem?.price?.recurring_interval && !lineItem?.price?.recurring_period_count,\n    );\n  }\n\n  renderLineItemTitle(checkout: Checkout) {\n    if (this.total === 'total' && this.hasInstallmentPlan(checkout)) {\n      return (\n        <span slot=\"title\">\n          <slot name=\"first-payment-total-description\">{__('Subtotal', 'surecart')}</slot>\n        </span>\n      );\n    }\n\n    return (\n      <span slot=\"title\">\n        <slot name=\"title\" />\n      </span>\n    );\n  }\n\n  renderLineItemDescription(checkout: Checkout) {\n    if (this.total === 'subtotal' && this.hasInstallmentPlan(checkout)) {\n      return (\n        <span slot=\"description\">\n          <slot name=\"first-payment-subtotal-description\">{__('Initial Payment', 'surecart')}</slot>\n        </span>\n      );\n    }\n\n    return (\n      <span slot=\"description\">\n        <slot name=\"description\" />\n      </span>\n    );\n  }\n\n  // Determine if the currency should be displayed to avoid duplication in the amount display.\n  getCurrencyToDisplay() {\n    const checkout = this.checkout || checkoutState?.checkout;\n    return checkout?.amount_due_default_currency_display_amount?.toLowerCase()?.includes(checkout?.currency?.toLowerCase()) ? '' : checkout?.currency?.toUpperCase();\n  }\n\n  renderConversion() {\n    if (this.total !== 'total') {\n      return null;\n    }\n\n    const checkout = this.checkout || checkoutState?.checkout;\n\n    if (!checkout?.show_converted_total) {\n      return null;\n    }\n\n    // the currency is the same as the current currency.\n    if (checkout?.currency === checkout?.current_currency) {\n      return null;\n    }\n\n    // there is no amount due.\n    if (!checkout?.amount_due) {\n      return null;\n    }\n\n    return (\n      <Fragment>\n        <sc-divider></sc-divider>\n        <sc-line-item style={{ '--price-size': 'var(--sc-font-size-x-large)' }}>\n          <span slot=\"title\">\n            <slot name=\"charge-amount-description\">{__('Payment Total', 'surecart')}</slot>\n          </span>\n          <span slot=\"price\">\n            {this.getCurrencyToDisplay() && <span class=\"currency-label\">{this.getCurrencyToDisplay()}</span>}\n            {checkout?.amount_due_default_currency_display_amount}\n          </span>\n        </sc-line-item>\n        <sc-line-item>\n          <span slot=\"description\" class=\"conversion-description\">\n            {/* translators: %s is the currency code */}\n            {sprintf(__('Your payment will be processed in %s.', 'surecart'), checkout?.currency?.toUpperCase())}\n          </span>\n        </sc-line-item>\n      </Fragment>\n    );\n  }\n\n  render() {\n    const checkout = this.checkout || checkoutState?.checkout;\n    // loading state\n    if (formBusy() && !checkout?.[this?.order_key?.[this?.total]]) {\n      return (\n        <sc-line-item>\n          <sc-skeleton slot=\"title\" style={{ width: '120px', display: 'inline-block' }}></sc-skeleton>\n          <sc-skeleton slot=\"price\" style={{ 'width': '70px', 'display': 'inline-block', 'height': this.size === 'large' ? '40px' : '', '--border-radius': '6px' }}></sc-skeleton>\n        </sc-line-item>\n      );\n    }\n\n    if (!checkout?.currency) return;\n\n    // if the total amount is different than the amount due.\n    if (this.total === 'total' && checkout?.total_amount !== checkout?.amount_due) {\n      return (\n        <div class=\"line-item-total__group\">\n          <sc-line-item>\n            <span slot=\"description\">\n              {this.hasInstallmentPlan(checkout) ? (\n                this.renderLineItemTitle(checkout)\n              ) : (\n                <Fragment>\n                  <slot name=\"title\" />\n                  <slot name=\"description\" />\n                </Fragment>\n              )}\n            </span>\n            <span slot=\"price\">\n              <sc-total total={this.total}></sc-total>\n            </span>\n          </sc-line-item>\n\n          {!!checkout.trial_amount && (\n            <sc-line-item>\n              <span slot=\"description\">\n                <slot name=\"free-trial-description\">{__('Trial', 'surecart')}</slot>\n              </span>\n              <span slot=\"price\">{checkout?.trial_display_amount}</span>\n            </sc-line-item>\n          )}\n\n          <sc-line-item style={{ '--price-size': 'var(--sc-font-size-x-large)' }}>\n            {this.hasSubscription(checkout) ? (\n              <span slot=\"title\">\n                <slot name=\"subscription-title\">{__('Total Due Today', 'surecart')}</slot>\n              </span>\n            ) : (\n              <span slot=\"title\">\n                <slot name=\"due-amount-description\">{__('Amount Due', 'surecart')}</slot>\n              </span>\n            )}\n\n            <span slot=\"price\">{checkout?.amount_due_display_amount}</span>\n          </sc-line-item>\n\n          {this.renderConversion()}\n        </div>\n      );\n    }\n\n    return (\n      <Fragment>\n        {this.total === 'subtotal' && this.hasInstallmentPlan(checkout) && (\n          <sc-line-item style={this.size === 'large' ? { '--price-size': 'var(--sc-font-size-x-large)' } : {}}>\n            <span slot=\"description\">\n              <slot name=\"total-payments-description\">{__('Total Installment Payments', 'surecart')}</slot>\n            </span>\n            <span slot=\"price\">{checkout?.full_display_amount}</span>\n          </sc-line-item>\n        )}\n\n        <sc-line-item style={this.size === 'large' ? { '--price-size': 'var(--sc-font-size-x-large)' } : {}}>\n          {this.renderLineItemTitle(checkout)}\n          {this.renderLineItemDescription(checkout)}\n          <span slot=\"price\">\n            {!!checkout?.total_savings_amount && this.total === 'total' && <span class=\"scratch-price\">{checkout?.total_scratch_display_amount}</span>}\n            <sc-total class=\"total-price\" total={this.total}></sc-total>\n          </span>\n        </sc-line-item>\n\n        {this.renderConversion()}\n      </Fragment>\n    );\n  }\n}\n"]}