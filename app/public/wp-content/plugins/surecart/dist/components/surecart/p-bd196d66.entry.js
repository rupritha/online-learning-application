import{r as i,h as s,F as t}from"./p-e97fde0a.js";import{a as e}from"./p-d9fa04f9.js";import{p as n,i as l}from"./p-4df6e0c5.js";import{a}from"./p-401e165e.js";import"./p-d3366af3.js";import"./p-3f6362a4.js";const o=(i,s)=>["BIF","BYR","CLP","DJF","GNF","ISK","JPY","KMF","KRW","PYG","RWF","UGX","VND","VUV","XAF","XAG","XAU","XBA","XBB","XBC","XBD","XDR","XOF","XPD","XPF","XPT","XTS"].includes(s?.toUpperCase())?i:i/100;const r=(i,s="")=>new Intl.NumberFormat([],{style:"currency",currency:s.toUpperCase(),currencyDisplay:"symbol"}).format(o(i,s.toUpperCase()));const d=":host{display:block}.subscription-details{display:grid;gap:0.25em;color:var(--sc-input-label-color)}.subscription-details__missing-method{display:flex;align-items:center;gap:var(--sc-spacing-x-small)}";const c=d;const u=class{constructor(s){i(this,s);this.subscription=undefined;this.pendingPrice=undefined;this.hideRenewalText=undefined;this.activationsModal=undefined;this.loading=undefined;this.hasPendingUpdate=undefined}renderName(){var i,s,t;if(typeof((s=(i=this.subscription)===null||i===void 0?void 0:i.price)===null||s===void 0?void 0:s.product)!=="string"){return n((t=this.subscription)===null||t===void 0?void 0:t.price)}return wp.i18n.__("Subscription","surecart")}async handleSubscriptionChange(){var i,s,t,e;this.hasPendingUpdate=!!((s=Object.keys(((i=this===null||this===void 0?void 0:this.subscription)===null||i===void 0?void 0:i.pending_update)||{}))===null||s===void 0?void 0:s.length);if(((e=(t=this===null||this===void 0?void 0:this.subscription)===null||t===void 0?void 0:t.pending_update)===null||e===void 0?void 0:e.price)&&!(this===null||this===void 0?void 0:this.pendingPrice)&&!this.hideRenewalText){this.pendingPrice=await this.fetchPrice(this.subscription.pending_update.price)}}componentWillLoad(){this.handleSubscriptionChange()}async fetchPrice(i){try{this.loading=true;const s=await e({path:a(`surecart/v1/prices/${i}`,{expand:["product"]})});return s}catch(i){console.error(i)}finally{this.loading=false}}renderRenewalText(){var i,t,e,n,a,o,d,c,u,v,h,p,f,b,w,y,g,m,k,x,X,Y,P;const _=s("sc-subscription-status-badge",{subscription:this===null||this===void 0?void 0:this.subscription});if(((i=this===null||this===void 0?void 0:this.subscription)===null||i===void 0?void 0:i.cancel_at_period_end)&&((t=this===null||this===void 0?void 0:this.subscription)===null||t===void 0?void 0:t.current_period_end_at)){return s("span",{"aria-label":wp.i18n.sprintf(wp.i18n.__("Renewal Update - Your plan will be canceled on %s","surecart"),this.subscription.current_period_end_at_date)},_," ",wp.i18n.sprintf(wp.i18n.__("Your plan will be canceled on %s","surecart"),this.subscription.current_period_end_at_date))}if(this.hasPendingUpdate){if(!this.pendingPrice&&!((n=(e=this.subscription)===null||e===void 0?void 0:e.pending_update)===null||n===void 0?void 0:n.ad_hoc_amount)){return s("sc-skeleton",null)}if((o=(a=this.subscription)===null||a===void 0?void 0:a.pending_update)===null||o===void 0?void 0:o.ad_hoc_amount){return s("span",{"aria-label":wp.i18n.sprintf(wp.i18n.__("Renewal Update - Your plan switches to %1s on %2s","surecart"),r((c=(d=this.subscription)===null||d===void 0?void 0:d.pending_update)===null||c===void 0?void 0:c.ad_hoc_amount,((u=this.pendingPrice)===null||u===void 0?void 0:u.currency)||((h=(v=this.subscription)===null||v===void 0?void 0:v.price)===null||h===void 0?void 0:h.currency)),this.subscription.current_period_end_at_date)},wp.i18n.__("Your plan switches to","surecart")," ",s("strong",null,s("sc-format-number",{type:"currency",currency:((p=this.pendingPrice)===null||p===void 0?void 0:p.currency)||((b=(f=this.subscription)===null||f===void 0?void 0:f.price)===null||b===void 0?void 0:b.currency),value:(y=(w=this.subscription)===null||w===void 0?void 0:w.pending_update)===null||y===void 0?void 0:y.ad_hoc_amount})," ",l(this.pendingPrice||((g=this.subscription)===null||g===void 0?void 0:g.price)))," ",wp.i18n.__("on","surecart")," ",this.subscription.current_period_end_at_date)}return s("span",{"aria-label":wp.i18n.sprintf(wp.i18n.__("Renewal Update - Your plan switches to %1s on %2s","surecart"),this.pendingPrice.product.name,this.subscription.current_period_end_at_date)},wp.i18n.__("Your plan switches to","surecart")," ",s("strong",null,this.pendingPrice.product.name)," ",wp.i18n.__("on","surecart")," ",this.subscription.current_period_end_at_date)}if(((m=this===null||this===void 0?void 0:this.subscription)===null||m===void 0?void 0:m.status)==="trialing"&&((k=this===null||this===void 0?void 0:this.subscription)===null||k===void 0?void 0:k.trial_end_at)){return s("span",{"aria-label":wp.i18n.sprintf(wp.i18n.__("Renewal Update - Your plan begins on %s.","surecart"),this.subscription.trial_end_at_date)},_," ",wp.i18n.sprintf(wp.i18n.__("Your plan begins on %s","surecart"),(x=this===null||this===void 0?void 0:this.subscription)===null||x===void 0?void 0:x.trial_end_at_date))}if(((X=this.subscription)===null||X===void 0?void 0:X.status)==="active"&&((Y=this.subscription)===null||Y===void 0?void 0:Y.current_period_end_at)){return s("span",{"aria-label":wp.i18n.sprintf(wp.i18n.__("Renewal Update - Your next payment is on %s","surecart"),this.subscription.current_period_end_at_date)},_," ",((P=this.subscription)===null||P===void 0?void 0:P.remaining_period_count)===null?wp.i18n.sprintf(wp.i18n.__("Your plan renews on %s","surecart"),this.subscription.current_period_end_at_date):wp.i18n.sprintf(wp.i18n.__("Your next payment is on %s","surecart"),this.subscription.current_period_end_at_date))}return _}getActivations(){var i,s,t,e;return(((e=(t=(s=(i=this.subscription)===null||i===void 0?void 0:i.purchase)===null||s===void 0?void 0:s.license)===null||t===void 0?void 0:t.activations)===null||e===void 0?void 0:e.data)||[]).filter((i=>i===null||i===void 0?void 0:i.counted))}renderActivations(){var i;const t=this.getActivations();if(!(t===null||t===void 0?void 0:t.length))return null;return s("sc-flex",{justifyContent:"flex-start",alignItems:"center"},s("sc-tag",{size:"small"},(i=t===null||t===void 0?void 0:t[0])===null||i===void 0?void 0:i.name),(t===null||t===void 0?void 0:t.length)>1&&s("sc-text",{style:{"--font-size":"var(--sc-font-size-small)",cursor:"pointer"},onClick:i=>{i.preventDefault();i.stopImmediatePropagation();this.activationsModal=true}},"+ ",(t===null||t===void 0?void 0:t.length)-1," More"))}showWarning(){var i,s,t,e,n,l,a;if(((i=this.subscription)===null||i===void 0?void 0:i.payment_method)||this.subscription.manual_payment){return false}if(!["active","past_due","unpaid","incomplete"].includes((s=this.subscription)===null||s===void 0?void 0:s.status)){return false}if((e=(t=this.subscription)===null||t===void 0?void 0:t.price)===null||e===void 0?void 0:e.ad_hoc){return((n=this.subscription)===null||n===void 0?void 0:n.ad_hoc_amount)!==0}return((a=(l=this.subscription)===null||l===void 0?void 0:l.price)===null||a===void 0?void 0:a.amount)!==0}render(){return s("div",{key:"746af28d3128b0da8f1aa894dcc0bec1b1f0f996",class:"subscription-details"},this.hasPendingUpdate&&s("div",{key:"210ede46b07a8ace73b327acb4444fb94f29586d"},s("sc-tag",{key:"969af1e4ebe5b683628da1f4d70d692a01356b04",size:"small",type:"warning"},wp.i18n.__("Update Scheduled","surecart"))),s("sc-flex",{key:"688ada18a3b98e3039678865093c60d614aba985",alignItems:"center",justifyContent:"flex-start"},s("sc-text",{key:"f14c9e7ce84a1e956a6d24b3083494772d7be6f0","aria-label":wp.i18n.sprintf(wp.i18n.__("Plan name - %s","surecart"),this.renderName()),style:{"--font-weight":"var(--sc-font-weight-bold)"}},this.renderName()),this.renderActivations()),!this.hideRenewalText&&s("div",{key:"b7beba76996cc98b2943fe0b74e790a0a5a08260"},this.renderRenewalText()," "),s("slot",{key:"26919ad0c8d6e963ac17722edd436497a33d6d9b"}),s("sc-dialog",{key:"6d33abc7b653e8345f39a892c53a12a1587f8f4b",label:wp.i18n.__("Activations","surecart"),onScRequestClose:()=>this.activationsModal=false,open:!!this.activationsModal},s("sc-card",{key:"ce15c11bcc5a4fa3d02cd3820948fb5f45ad2620","no-padding":true,style:{"--overflow":"hidden"}},s("sc-stacked-list",{key:"9ccfd914b9e13794b63eb0640280b92eb832f20f"},(this.getActivations()||[]).map((i=>s("sc-stacked-list-row",{style:{"--columns":"2"},mobileSize:0},s("sc-text",{style:{"--line-height":"var(--sc-line-height-dense)"}},s("strong",null,i===null||i===void 0?void 0:i.name),s("div",null,s("sc-text",{style:{"--color":"var(--sc-color-gray-500)"}},i===null||i===void 0?void 0:i.fingerprint))),s("sc-text",{style:{"--color":"var(--sc-color-gray-500)"}},i===null||i===void 0?void 0:i.created_at_date))))))),this.showWarning()&&s("div",{key:"7fc4f2f405849158178256de5effd505a1ebb8cc"},s("sc-tag",{key:"21c1f847e72f6b4239780f583d23f4a8426b42b4",type:"warning"},s("div",{key:"899c234708119e05cb2ba0ff02dabe02b4161303",class:"subscription-details__missing-method"},s("sc-icon",{key:"05f851fae92cf4bcc0ecceadc19b4a5ca05bfe45",name:"alert-triangle"}),wp.i18n.__("Payment Method Missing","surecart")))))}static get watchers(){return{subscription:["handleSubscriptionChange"]}}};u.style=c;const v=":host{display:inline-block}";const h=v;const p=class{constructor(s){i(this,s);this.status=undefined;this.subscription=undefined;this.size="medium";this.pill=false;this.clearable=false}getType(){var i,s,t;if((i=this.subscription)===null||i===void 0?void 0:i.cancel_at_period_end){return"info"}switch(this.status||((s=this.subscription)===null||s===void 0?void 0:s.status)){case"incomplete":return"warning";case"trialing":return"info";case"active":return"success";case"completed":return"success";case"past_due":return"warning";case"canceled":if((t=this.subscription)===null||t===void 0?void 0:t.restore_at){return"info"}return"danger";case"unpaid":return"warning"}}getText(){var i,e,n,l,a;if(((i=this.subscription)===null||i===void 0?void 0:i.cancel_at_period_end)&&this.subscription.current_period_end_at&&((e=this.subscription)===null||e===void 0?void 0:e.status)!=="canceled"){return s(t,null,!!((n=this.subscription)===null||n===void 0?void 0:n.restore_at)?wp.i18n.__("Pauses","surecart"):wp.i18n.__("Cancels","surecart")," ",this.subscription.current_period_end_at_date)}switch(this.status||((l=this.subscription)===null||l===void 0?void 0:l.status)){case"incomplete":return wp.i18n.__("Incomplete","surecart");case"trialing":return wp.i18n.__("Trialing","surecart");case"active":return wp.i18n.__("Active","surecart");case"past_due":return wp.i18n.__("Past Due","surecart");case"canceled":if((a=this.subscription)===null||a===void 0?void 0:a.restore_at){return"Paused"}return wp.i18n.__("Canceled","surecart");case"completed":return wp.i18n.__("Completed","surecart");case"unpaid":return wp.i18n.__("Unpaid","surecart")}}render(){return s("sc-tag",{key:"194460f3977d263ade1bda350c3addf1ce102eaa","aria-label":wp.i18n.sprintf(wp.i18n.__("Plan Status - %s","surecart"),this.getText()),type:this.getType()},this.getText())}};p.style=h;export{u as sc_subscription_details,p as sc_subscription_status_badge};
//# sourceMappingURL=p-bd196d66.entry.js.map